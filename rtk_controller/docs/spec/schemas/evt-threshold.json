{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://rtk.mqtt/schemas/evt-threshold/1.0",
  "title": "RTK MQTT Threshold Event Schema",
  "description": "Schema for threshold exceeded events",
  "allOf": [
    {
      "$ref": "event.json"
    },
    {
      "properties": {
        "schema": {
          "enum": ["evt.threshold/1.0"]
        },
        "payload": {
          "properties": {
            "event_type": {
              "enum": ["threshold_exceeded"]
            },
            "sensor_type": {
              "type": "string",
              "enum": ["temperature", "humidity", "cpu", "memory", "disk", "network", "power"],
              "description": "感測器類型"
            },
            "current_value": {
              "type": "number",
              "description": "當前值"
            },
            "threshold_value": {
              "type": "number",
              "description": "閾值"
            },
            "threshold_type": {
              "type": "string",
              "enum": ["max", "min"],
              "description": "閾值類型"
            },
            "unit": {
              "type": "string",
              "description": "數值單位"
            },
            "duration_s": {
              "type": "integer",
              "minimum": 0,
              "description": "超過閾值持續時間(秒)"
            }
          },
          "required": ["event_type", "sensor_type", "current_value", "threshold_value", "threshold_type"],
          "additionalProperties": false
        }
      }
    }
  ]
}